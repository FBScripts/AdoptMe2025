-- ==========================================
-- –ê–ì–†–ï–°–°–ò–í–ù–´–ô –°–ö–†–ò–ü–¢ –î–õ–Ø –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ì–û –ü–û–ö–ê–ó–ê BACKPACK
-- ==========================================

local function forceBackpackVisible()
    print("=== –ó–ê–ü–£–°–ö –ê–ì–†–ï–°–°–ò–í–ù–û–ì–û –°–ö–†–ò–ü–¢–ê BACKPACK ===")
    
    -- –ó–∞–≥—Ä—É–∂–∞–µ–º Fsys
    if not _G.Fsys then
        _G.Fsys = require(game:GetService("ReplicatedStorage").Fsys)
    end
    
    local Fsys = _G.Fsys
    
    -- 1. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º BackpackFilter
    local backpackThread = task.spawn(function()
        while true do
            pcall(function()
                local BackpackFilter = Fsys.load("BackpackFilter")
                if BackpackFilter and BackpackFilter.set_visible then
                    BackpackFilter:set_visible(true)
                    print("üîß –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º BackpackFilter")
                end
            end)
            task.wait(0.1) -- –ö–∞–∂–¥—ã–µ 0.1 —Å–µ–∫—É–Ω–¥—ã
        end
    end)
    
    -- 2. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º FocusPetApp
    local focusPetThread = task.spawn(function()
        while true do
            pcall(function()
                local FocusPetApp = Fsys.load("FocusPetApp")
                if FocusPetApp and FocusPetApp.show_ui then
                    FocusPetApp:show_ui()
                    print("üëÅÔ∏è –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º FocusPetApp UI")
                end
                
                -- –¢–∞–∫–∂–µ –ø—Ä–æ–±—É–µ–º –º–µ—Ç–æ–¥ show
                if FocusPetApp and FocusPetApp.show then
                    FocusPetApp:show()
                end
            end)
            task.wait(0.15)
        end
    end)
    
    -- 3. –ù–∞—Ö–æ–¥–∏–º –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º GUI —ç–ª–µ–º–µ–Ω—Ç—ã —Ä—é–∫–∑–∞–∫–∞
    local guiThread = task.spawn(function()
        while true do
            pcall(function()
                local players = game:GetService("Players")
                local localPlayer = players.LocalPlayer
                if localPlayer then
                    local playerGui = localPlayer:FindFirstChild("PlayerGui")
                    if playerGui then
                        -- –ò—â–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å "backpack" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
                        for _, guiObject in pairs(playerGui:GetDescendants()) do
                            if guiObject:IsA("GuiObject") and 
                               (string.find(guiObject.Name:lower(), "backpack") or
                                string.find(guiObject.Name:lower(), "inventory")) then
                                guiObject.Visible = true
                                if guiObject:FindFirstChild("Visible") then
                                    guiObject.Visible.Value = true
                                end
                            end
                        end
                        
                        -- –û—Å–æ–±–µ–Ω–Ω–æ –∏—â–µ–º OpenBackpackContainer
                        local openBackpack = playerGui:FindFirstChild("OpenBackpackContainer", true)
                        if openBackpack and openBackpack:IsA("GuiObject") then
                            openBackpack.Visible = true
                            print("üéí –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º OpenBackpackContainer")
                        end
                    end
                end
            end)
            task.wait(0.2)
        end
    end)
    
    -- 4. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫—Ä—ã—Ç–∏—è
    pcall(function()
        local FocusPetApp = Fsys.load("FocusPetApp")
        if FocusPetApp then
            -- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
            local originalFunctions = {}
            
            -- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º hide_ui
            if FocusPetApp.hide_ui then
                originalFunctions.hide_ui = FocusPetApp.hide_ui
                FocusPetApp.hide_ui = function(...)
                    print("üö´ BLOCKED: hide_ui called")
                    return true -- –ë–ª–æ–∫–∏—Ä—É–µ–º
                end
            end
            
            -- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º hide
            if FocusPetApp.hide then
                originalFunctions.hide = FocusPetApp.hide
                FocusPetApp.hide = function(...)
                    print("üö´ BLOCKED: hide called")
                    return true -- –ë–ª–æ–∫–∏—Ä—É–µ–º
                end
            end
        end
    end)
    
    -- 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–º —Å–æ–±—ã—Ç–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º UI
    pcall(function()
        local TradeApp = Fsys.load("TradeApp")
        if TradeApp then
            -- –ò—â–µ–º —Å–æ–±—ã—Ç–∏—è –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º –∏—Ö
            for key, value in pairs(TradeApp) do
                if type(value) == "table" and getmetatable(value) then
                    -- –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ RBXScriptSignal (—Å–æ–±—ã—Ç–∏–µ)
                    if value.Connect then
                        value:Connect(function()
                            print("üîî –°–æ–±—ã—Ç–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏:", key)
                            -- –ü—Ä–∏ —Å–æ–±—ã—Ç–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä—é–∫–∑–∞–∫
                            task.spawn(function()
                                task.wait(0.5)
                                pcall(forceBackpackVisible)
                            end)
                        end)
                    end
                end
            end
        end
    end)
    
    -- 6. –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    local function createStatusPanel()
        if not game:GetService("CoreGui"):FindFirstChild("BackpackForce") then
            local ScreenGui = Instance.new("ScreenGui")
            ScreenGui.Name = "BackpackForce"
            ScreenGui.Parent = game:GetService("CoreGui")
            
            local Frame = Instance.new("Frame")
            Frame.Size = UDim2.new(0, 250, 0, 80)
            Frame.Position = UDim2.new(0, 10, 0, 10)
            Frame.BackgroundColor3 = Color3.new(0, 0.3, 0)
            Frame.BackgroundTransparency = 0.2
            Frame.Parent = ScreenGui
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(1, 0, 0, 30)
            Label.Text = "BACKPACK FORCE: ACTIVE"
            Label.TextColor3 = Color3.new(0, 1, 0)
            Label.BackgroundTransparency = 1
            Label.TextScaled = true
            Label.Parent = Frame
            
            local Status = Instance.new("TextLabel")
            Status.Size = UDim2.new(1, 0, 0, 40)
            Status.Position = UDim2.new(0, 0, 0, 35)
            Status.Text = "–†—é–∫–∑–∞–∫ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è\n–∫–∞–∂–¥—ã–µ 0.1 —Å–µ–∫—É–Ω–¥—ã"
            Status.TextColor3 = Color3.new(1, 1, 1)
            Status.BackgroundTransparency = 1
            Status.TextScaled = true
            Status.Parent = Frame
        end
    end
    
    pcall(createStatusPanel)
    
    print("‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!")
    print("üìä BackpackFilter –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 0.1—Å")
    print("üìä FocusPetApp –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 0.15—Å") 
    print("üìä GUI —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 0.2—Å")
    print("üéí –†—é–∫–∑–∞–∫ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤–∏–¥–∏–º—ã–º –¥–∞–∂–µ –ø—Ä–∏ —Ç—Ä–µ–π–¥–µ!")
    
    -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    return {
        stop = function()
            task.cancel(backpackThread)
            task.cancel(focusPetThread)
            task.cancel(guiThread)
            print("üõë –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        end,
        
        forceShow = function()
            pcall(function()
                local BackpackFilter = Fsys.load("BackpackFilter")
                if BackpackFilter and BackpackFilter.set_visible then
                    BackpackFilter:set_visible(true)
                end
                
                local FocusPetApp = Fsys.load("FocusPetApp")
                if FocusPetApp and FocusPetApp.show_ui then
                    FocusPetApp:show_ui()
                end
            end)
        end
    }
end

-- –ó–ê–ü–£–°–ö–ê–ï–ú –ê–ì–†–ï–°–°–ò–í–ù–´–ô –°–ö–†–ò–ü–¢
local backpackController = forceBackpackVisible()

-- –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û: –ü–æ–∏—Å–∫ —Ç–æ—á–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ —Ä—é–∫–∑–∞–∫—É
local function findExactBackpackPath()
    print("\n=== –ü–û–ò–°–ö –¢–û–ß–ù–û–ì–û –ü–£–¢–ò –ö BACKPACK ===")
    
    local players = game:GetService("Players")
    local localPlayer = players.LocalPlayer
    if localPlayer then
        local playerGui = localPlayer:FindFirstChild("PlayerGui")
        if playerGui then
            -- –ò—â–µ–º –≤—Å–µ —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å backpack
            for _, descendant in pairs(playerGui:GetDescendants()) do
                if string.find(descendant.Name:lower(), "backpack") then
                    print("üéí –ù–∞–π–¥–µ–Ω:", descendant:GetFullName())
                    
                    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤–æ–π—Å—Ç–≤–∞
                    if descendant:IsA("GuiObject") then
                        print("   üëÅÔ∏è  Visible:", descendant.Visible)
                        print("   üéØ Active:", descendant.Active)
                    end
                    
                    -- –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∏—â–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–∫—Ä—ã—Ç–∏—è
                    if descendant.Name == "OpenBackpackContainer" then
                        local openButton = descendant:FindFirstChild("OpenBackpack")
                        if openButton then
                            print("   üîò –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è:", openButton:GetFullName())
                        end
                    end
                end
            end
        end
    end
end

-- –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–∏—Å–∫ –ø—É—Ç–∏
findExactBackpackPath()

return backpackController
